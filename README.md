# ExpenseTracker API

A simple ASP .NET Core 8 Web API backend for an Expense Tracker application.
It uses MySQL (via Pomelo.EntityFrameworkCore.MySql), JWT-based authentication, EF Core migrations, and follows a clean separation of concerns (Models, DTOs, Interfaces, Services, Middleware, Controllers).

---

## Table of Contents

1. [Features](#features)
2. [Prerequisites](#prerequisites)
3. [Project Structure](#project-structure)
4. [Setup & Installation](#setup--installation)
5. [Configuration](#configuration)
6. [Database Migrations](#database-migrations)
7. [Running the App](#running-the-app)
8. [API Endpoints](#api-endpoints)
9. [Testing with Postman](#testing-with-postman)
10. [Technologies](#technologies)
11. [Contributing](#contributing)
12. [License](#license)
13. [Author](#author)

---

## Features

* User registration & login (JWT-auth)
* `UsersController` for retrieving user data (protected)
* EF Core with MySQL backend
* DotNetEnv for `.env` configuration
* Global error handling & JWT middleware
* Swagger / OpenAPI support

---

## Prerequisites

* [.NET 8 SDK](https://dotnet.microsoft.com/download/dotnet/8.0)
* [MySQL Server](https://dev.mysql.com/downloads/) (or MariaDB)
* (Optional) MySQL Workbench or another GUI client
* `dotnet-ef` CLI tool

  ```bash
  dotnet tool install --global dotnet-ef
  ```

---

## Project Structure

```
ExpenseTrackerApi/
├── .env
├── Program.cs
├── appsettings.json
├── Controllers/
│   ├── AuthController.cs
│   └── UsersController.cs
├── DTOs/
│   └── Auth/
│       ├── LoginDto.cs
│       └── RegisterDto.cs
├── Data/
│   └── AppDbContext.cs
├── Helpers/
│   └── JwtSettings.cs
├── Interfaces/
│   ├── IAuthService.cs
│   └── IUserService.cs
├── Middleware/
│   ├── ErrorHandlingMiddleware.cs
│   └── JwtMiddleware.cs
├── Models/
│   └── User.cs
├── Services/
│   ├── AuthService.cs
│   └── UserService.cs
└── Migrations/      ← auto-generated by EF Core
```

---

## Setup & Installation

1. **Clone the repo**

   ```bash
   git clone https://github.com/AssaniIndraprasitdhi/ExpenseTrackerApi.git
   cd ExpenseTrackerApi
   ```

2. **Restore NuGet packages**

   ```bash
   dotnet restore
   ```

3. **Install EF Core design package** (if not already)

   ```bash
   dotnet add package Microsoft.EntityFrameworkCore.Design --version 8.0.16
   ```

---

## Configuration

1. **Create a `.env` file** in the project root:

   ```dotenv
   DB_CONNECTION_STRING=Server=localhost;Port=3306;Database=ExpenseTracker;Uid=root;Pwd=your_password;
   JWT_SECRET=YourVeryStrongJwtSecretKey
   JWT_EXPIRES_IN_DAYS=7
   ```

2. **(Optional)** adjust any other settings in `appsettings.json`.

---

## Database Migrations

1. **Create the initial migration**

   ```bash
   dotnet ef migrations add InitialCreate
   ```

2. **Apply migrations to your database**

   ```bash
   dotnet ef database update
   ```

3. **Verify**

   * Open MySQL Workbench (or CLI) and confirm that the `Users` table exists.

---

## Running the App

```bash
 dotnet run
```

By default:

* HTTP on `http://localhost:5000`
* HTTPS on `https://localhost:5001`

Swagger UI (in Development) at:

```
GET https://localhost:5001/swagger/index.html
```

---

## API Endpoints

### Authentication

| Method | URL                  | Body                               | Description           |
| ------ | -------------------- | ---------------------------------- | --------------------- |
| POST   | `/api/auth/register` | `{ "username":"", "password":"" }` | Register new user     |
| POST   | `/api/auth/login`    | `{ "username":"", "password":"" }` | Login & get JWT token |

### Users (Protected)

> **Headers:**
> `Authorization: Bearer {token}`

| Method | URL               | Description    |
| ------ | ----------------- | -------------- |
| GET    | `/api/users`      | Get all users  |
| GET    | `/api/users/{id}` | Get user by ID |

---

## Testing with Postman

1. **Register**

   * POST `{{baseUrl}}/api/auth/register`
   * Body (JSON):

     ```json
     { "username": "alice", "password": "P@ssw0rd!" }
     ```

2. **Login**

   * POST `{{baseUrl}}/api/auth/login`
   * Body:

     ```json
     { "username": "alice", "password": "P@ssw0rd!" }
     ```
   * Copy the returned `token`.

3. **Get Users**

   * GET `{{baseUrl}}/api/users`
   * Add Header:

     ```
     Authorization: Bearer {{token}}
     ```

4. **Get User by ID**

   * GET `{{baseUrl}}/api/users/1`
   * Same Bearer header.

---

## Technologies

* **.NET 8** / C#
* **EF Core** (Pomelo MySQL provider)
* **JWT Bearer Authentication**
* **DotNetEnv**
* **Swagger / Swashbuckle**

---

## Contributing

1. Fork the repo
2. Create a feature branch

   ```bash
   git checkout -b feature/YourFeature
   ```
3. Commit your changes
4. Push to your branch
5. Open a Pull Request

Please follow the existing code conventions and add unit tests where appropriate.

---

## License

This project is licensed under the [MIT License](LICENSE).

---

## Author

Assani Indraprasitdhi
Backend Developer | Full-Stack Enthusiast
